<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuromi æ’çƒè¨ˆåˆ†å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #F3E8FF; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        .kuromi-card { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.4); }
        .btn-active { transform: scale(0.95); }
    </style>
</head>
<body class="p-4 text-[#4C1D95]">
    <div id="app" class="max-w-md mx-auto">
        <!-- é ‚éƒ¨è³‡è¨Š -->
        <div class="flex justify-between items-center mb-4">
            <div>
                <select id="matchType" class="bg-transparent font-bold text-lg outline-none">
                    <option>ğŸ† è¯è³½</option><option>ğŸ“Š æ’ä½è³½</option><option>ğŸ–ï¸ éŒ¦æ¨™è³½</option><option>ğŸ æ™®é€šæ¯”è³½</option>
                </select>
                <div id="currentDate" class="text-xs opacity-60">2024-05-20</div>
            </div>
            <button onclick="undo()" class="p-2 bg-white rounded-full shadow-sm">â†© è¿”å›</button>
        </div>

        <!-- æ¯”åˆ†æ¿ -->
        <div class="kuromi-card rounded-[30px] p-6 shadow-sm mb-6 text-center">
            <div class="flex justify-around items-center">
                <div>
                    <div class="text-xs opacity-60 mb-1">æˆ‘æ–¹</div>
                    <div id="scoreA" class="text-6xl font-black text-[#8B5CF6]">0</div>
                    <div id="setsA" class="mt-2 text-sm font-bold text-pink-400">Sets: 0</div>
                </div>
                <div class="text-3xl opacity-20">:</div>
                <div>
                    <div class="text-xs opacity-60 mb-1">å°æ‰‹</div>
                    <div id="scoreB" class="text-6xl font-black opacity-40">0</div>
                    <div id="setsB" class="mt-2 text-sm font-bold opacity-20">Sets: 0</div>
                </div>
            </div>
        </div>

        <!-- ç”·å‹ç‹€æ…‹åˆ‡æ› -->
        <div class="flex justify-center mb-6">
            <button id="statusBtn" onclick="toggleStatus()" class="px-6 py-2 rounded-full bg-[#FFD1E8] font-bold shadow-sm transition-all">
                ğŸ˜ˆ ç”·å‹åœ¨å ´ä¸Š
            </button>
        </div>

        <!-- æŒ‰éˆ•å€ -->
        <div id="actionGrid" class="grid grid-cols-2 gap-3 mb-6">
            <!-- ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
        </div>

        <!-- é€šç”¨åŠ åˆ† -->
        <div class="grid grid-cols-2 gap-3 pt-4 border-t border-purple-200">
            <button onclick="changeScore('A')" class="py-4 bg-purple-400 text-white rounded-2xl font-bold">éšŠå‹å¾—åˆ†</button>
            <button onclick="changeScore('B')" class="py-4 bg-gray-400 text-white rounded-2xl font-bold">å°æ‰‹å¾—åˆ†</button>
        </div>

        <!-- å‚™è¨» -->
        <textarea id="memo" placeholder="å¯«ä¸‹ç•¶å‰å‚™è¨»..." class="w-full mt-6 p-4 rounded-2xl bg-white/50 border-none text-sm h-24 outline-none"></textarea>
    </div>

    <!-- å½ˆå‡ºç¢ºèªè¦–çª— -->
    <div id="confirmBox" class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-6 z-50">
        <div class="bg-white rounded-[30px] p-8 w-full max-w-sm text-center">
            <h2 class="text-xl font-bold mb-2">æœ¬å±€çµæŸäº†å—ï¼ŸğŸ˜ˆ</h2>
            <p id="confirmScore" class="mb-6 opacity-60">25 : 23</p>
            <button onclick="confirmSet()" class="w-full py-3 bg-[#8B5CF6] text-white rounded-full font-bold mb-3">ç¢ºå®šçµç®—</button>
            <button onclick="hideConfirm()" class="w-full py-3 bg-gray-100 rounded-full font-bold text-gray-400">æŒ‰éŒ¯äº†</button>
        </div>
    </div>

    <script>
        let data = { scoreA: 0, scoreB: 0, setsA: 0, setsB: 0, isBench: false };
        let history = [];
        const actions = ['æ®ºçƒ', 'æ””ç¶²', 'é–‹çƒ', 'æ¥çƒ'];

        function updateUI() {
            document.getElementById('scoreA').innerText = data.scoreA;
            document.getElementById('scoreB').innerText = data.scoreB;
            document.getElementById('setsA').innerText = `Sets: ${data.setsA}`;
            document.getElementById('setsB').innerText = `Sets: ${data.setsB}`;
            document.getElementById('statusBtn').innerText = data.isBench ? 'ğŸ˜´ ç”·å‹å¾Œå‚™ä¸­' : 'ğŸ˜ˆ ç”·å‹åœ¨å ´ä¸Š';
            document.getElementById('statusBtn').style.backgroundColor = data.isBench ? '#E2E8F0' : '#FFD1E8';
            
            const grid = document.getElementById('actionGrid');
            grid.innerHTML = '';
            if (!data.isBench) {
                actions.forEach(act => {
                    grid.innerHTML += `
                        <div class="bg-white/60 p-3 rounded-2xl text-center border border-white">
                            <div class="font-bold text-sm mb-2">${act}</div>
                            <button onclick="changeScore('A', '${act}')" class="w-full py-2 bg-pink-100 rounded-lg text-xs font-bold mb-1">å¾—åˆ† (+1)</button>
                            <button onclick="changeScore('B', '${act}')" class="w-full py-2 bg-gray-100 rounded-lg text-xs">å¤±æ•— (å°æ‰‹+1)</button>
                        </div>`;
                });
            }
        }

        function changeScore(team, act = null) {
            history.push(JSON.parse(JSON.stringify(data)));
            if (team === 'A') data.scoreA++; else data.scoreB++;
            
            const target = (data.setsA + data.setsB === 4) ? 15 : 25;
            if ((data.scoreA >= target || data.scoreB >= target) && Math.abs(data.scoreA - data.scoreB) >= 2) {
                document.getElementById('confirmScore').innerText = `${data.scoreA} : ${data.scoreB}`;
                document.getElementById('confirmBox').classList.remove('hidden');
            }
            updateUI();
        }

        function confirmSet() {
            if (data.scoreA > data.scoreB) data.setsA++; else data.setsB++;
            data.scoreA = 0; data.scoreB = 0;
            hideConfirm();
            updateUI();
        }

        function hideConfirm() { document.getElementById('confirmBox').classList.add('hidden'); }
        function toggleStatus() { data.isBench = !data.isBench; updateUI(); }
        function undo() { if (history.length > 0) { data = history.pop(); updateUI(); } }

        document.getElementById('currentDate').innerText = new Date().toLocaleDateString();
        updateUI();
    </script>
</body>
</html>
